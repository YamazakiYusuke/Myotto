<h1><%= t('.all_book') %></h1>

<%= search_form_for @search,url: books_path do |f| %>
  <%= f.label :title_cont, t('.title') %>
  <%= f.search_field :title_cont %>
  <%= f.label :book_locale_statuses_locale_id, t('.locale') %>
  <%= f.collection_select :book_locale_statuses_locale_id, Locale.all, :id, :name, include_blank: true %>
  <%= f.submit t('.search') %></div>
<% end %>

<h3><%= link_to t('.create_book'), new_book_path if admin_user? %></h3>
<br/>

<table>
  <thead>
    <tr>
      <th><%= t('.title') %></th>
      <th><%= t('.author') %></th>
      <th><%= t('.issued_date') %></th>
      <th><%= t('.difficulty') %></th>
      <th><%= t('.locale') %></th>
    </tr>
  </thead>

  <tbody>
    <% @books.each do |book| %>
      <tr>
        <td><%= book.title %></td>
        <td><%= book.author %></td>
        <td>
          <% if book.issued_date.present? %>
            <%= book.issued_date.strftime("%Y") %>
          <% else %>
            <%= t('.unknown') %>
          <% end %>
        </td>
        <td>
          <% if book.book_locale_statuses[0].difficulty.present? %>
            <%= book.book_locale_statuses[0].difficulty %> 
          <% else %>
            <%= t('.unknown') %>
          <% end %>
        </td>
        <td><%= book.book_locale_statuses[0].locale.name %></td>
        <td><%= link_to(t('.read'), book_path(book.id)) %></td>
        <td><%= link_to(t('.edit'), edit_book_path(book.id)) if admin_user? %></td>
        <td><%= link_to(t('.destroy'), book_path(book.id), method: :delete, data: { confirm: t('.are_you_sure') }) if admin_user? %></td>
      </tr>
    <% end %>
  </tbody>
</table>
<div><%= paginate @books %></div>
